<script
  src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
  crossorigin="anonymous"
></script>
<script src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    // Adicionar um pequeno atraso para garantir que o Bootstrap tenha terminado o layout
    setTimeout(function () {
      var grid = document.querySelector("#gallery");

      // Primeiro, garantir que as imagens estão carregadas
      imagesLoaded(grid, function () {
        // Inicializar o Masonry com as configurações corretas
        var msnry = new Masonry(grid, {
          itemSelector: ".grid-item",
          percentPosition: true,
          gutter: 16,
          transitionDuration: "0.3s",
        });

        // Forçar um layout refresh após um pequeno delay
        setTimeout(function () {
          msnry.layout();
        }, 100);
      });
    }, 100);
  });

  // Também recalcular o layout quando a janela for redimensionada
  window.addEventListener("resize", function () {
    var grid = document.querySelector("#gallery");
    if (grid && typeof Masonry !== "undefined") {
      var msnry = Masonry.data(grid);
      if (msnry) {
        setTimeout(function () {
          msnry.layout();
        }, 100);
      }
    }
  });
</script>
